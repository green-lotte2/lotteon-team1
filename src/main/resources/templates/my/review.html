<html xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{/layout/myLayout.html}">
<!--내용 시작-->
    <div id="my" layout:fragment="content">

        <script>
            window.onload = function () {
                let rating = document.getElementsByClassName("rating");
                Array.from(rating).forEach(function (element) {
                    const revScore = parseInt(element.innerText);
                    switch (revScore){
                        case 1:
                            element.classList.add('star1');
                            break;
                        case 2:
                            element.classList.add('star2');
                            break;
                        case 3:
                            element.classList.add('star3');
                            break;
                        case 4:
                            element.classList.add('star4');
                            break;
                        case 5:
                            element.classList.add('star5');
                            break;
                    }
                });
            }
        </script>

        <nav>
            <div>
                <a th:href="@{/my/home(userId=${#authentication.principal.user.userId})}"><img th:src="@{/images/my/my_logo.jpg}" alt="나의쇼핑정보"></a>
                <ol>
                    <li><a th:href="@{/my/order(userId=${#authentication.principal.user.userId})}">주문·배송<span class="delivery" th:text="${session.countOrder}"></span></a></li>
                    <li><a th:href="@{/my/coupon(userId=${#authentication.principal.user.userId})}">할인쿠폰<span class="coupon" th:text="${session.couponCount}"></span></a></li>
                    <li><a th:href="@{/my/point(userId=${#authentication.principal.user.userId})}">포인트<span class="point" th:text="${#numbers.formatInteger(session.pointBalance,3,'COMMA')}"></span></a></li>
                    <li><a th:href="@{/my/qna(userId=${#authentication.principal.user.userId})}">문의내역<span class="qna">1</span></a></li>
                </ol>
            </div>
        </nav>

        <div class="review">
            <ul>
                <span class="menu_else"></span>
                <li><a th:href="@{/my/order(userId=${#authentication.principal.user.userId})}">전체주문내역</a></li>
                <li><a th:href="@{/my/wish(userId=${#authentication.principal.user.userId})}">관심상품</a></li>
                <li><a th:href="@{/my/point(userId=${#authentication.principal.user.userId})}">포인트내역</a></li>
                <li><a th:href="@{/my/coupon(userId=${#authentication.principal.user.userId})}">쿠폰</a></li>
                <li><a th:href="@{/my/review(userId=${#authentication.principal.user.userId})}">나의리뷰</a></li>
                <li><a th:href="@{/my/qna(userId=${#authentication.principal.user.userId})}">문의하기</a></li>
                <li><a th:href="@{/my/info(userId=${#authentication.principal.user.userId})}">나의설정</a></li>
            </ul>

            <section th:each="banner : ${bannerMy1}">
                <a th:href="@{http://__${banner.banLink}__}"><img th:src="@{/uploads/__${banner.banImgName}__}" alt="패션, 타운 하나로 끝" class="banner"></a>
                <article>
                    <h3>나의리뷰</h3>

                    <table border="0">
                        <tr >
                            <th>번호</th>
                            <th>이미지</th>
                            <th>상품명</th>
                            <th>내용</th>
                            <th>평점</th>
                            <th>작성일</th>
                        </tr>
                        <tr th:each="eachReviewPage : ${myReviewPage.dtoList} ">
                            <td class="no" th:text="${eachReviewPage.revNo}"></td>
                            <td>
                                <img th:src="@{/uploads/__${eachReviewPage.revThumb}__}" style="width: 90px;">
                            </td>
                            <td class="prodName">
                                <a th:href="@{/product/view(prodNo=${eachReviewPage.prodNo})}" th:text="${eachReviewPage.prodName}"></a>
                            </td>
                            <td class="content" th:text="${eachReviewPage.revContent}"></td>
                            <td class="score">
                                <span class="rating" th:text="${eachReviewPage.revScore}"></span>
                            </td>
                            <td class="date" th:text="${#temporals.format(eachReviewPage.revAddDate, 'yyyy-MM-dd')}"></td>
                        </tr>
                    </table>



                    <p class="page">
                        <a th:if="${myReviewPage.prev && myReviewPage.cate == null}" th:href="@{/my/review(pg=${myReviewPage.start -1}, userId=${#authentication.principal.user.userId})}">이전</a>
                        <a th:if="${myReviewPage.prev && myReviewPage.cate != null}" th:href="@{/my/review(pg=${myReviewPage.start -1}, type=${myReviewPage.type}, keyword=${myReviewPage.keyword}, userId=${#authentication.principal.user.userId})}">이전</a>

                        <th:block th:each="num:${#numbers.sequence(myReviewPage.start, myReviewPage.end)}">
                            <a class="pageNum" th:if="${myReviewPage.cate == null}" th:href="@{/my/review(pg=${num}, userId=${#authentication.principal.user.userId})}" th:class="${num == myReviewPage} ? 'on' : ''">[[${num}]]</a>
                            <a class="pageNum" th:if="${myReviewPage.cate != null}" th:href="@{/my/review(pg=${num}, type=${myReviewPage.type}, cate=${myReviewPage.cate}, keyword=${myReviewPage.keyword}, userId=${#authentication.principal.user.userId})}" th:class="${num == 1} ? 'on' : ''">[[${num}]]</a>
                        </th:block>

                        <a th:if="${myReviewPage.next && myReviewPage.cate == null}" th:href="@{/my/review(pg=${myReviewPage.end + 1}, userId=${#authentication.principal.user.userId})}">다음</a>
                        <a th:if="${myReviewPage.next && myReviewPage.cate != null}" th:href="@{/my/review(pg=${myReviewPage.end + 1}, type=${myReviewPage.type}, keyword=${myReviewPage.keyword}, userId=${#authentication.principal.user.userId})}">다음</a>
                    </p>
                </article>
            </section>

        </div>
    </div>
<!--내용 끝-->
</html>